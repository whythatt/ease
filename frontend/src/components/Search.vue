<script setup>
import { ref } from 'vue'

const emit = defineEmits(['search'])

const inputValue = ref('')
const input = ref(null)
const file = ref(null)

const showFilters = ref(false)
const toggleFilters = () => {
    showFilters.value = !showFilters.value
}

const showInput = ref(false)
const toggleInput = () => {
    showInput.value = !showInput.value
}

const onEnter = (e) => {
    e.preventDefault()
    emit('search', inputValue.value)
    if (input.value) input.value.blur()
    file.value = null
    showInput.value = false
}

const onFileChange = (e) => {
    const files = e.target.files
    if (files.length > 0) {
        file.value = files[0]
        inputValue.value = '' // чистим input URL
        emit('search', file.value)
        file.value = null
    }
}
</script>

<template>
    <div v-if="showFilters" @click="toggleFilters" class="background"></div>
    <div class="search-con">
        <div class="for-search" :style="{ columnGap: !showInput ? '35px' : '5px' }">
            <svg @click="toggleInput" width="28" height="29" viewBox="0 0 28 29" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M23.6677 22.9997L27.7095 27.1837C27.898 27.3858 28.0023 27.6566 28 27.9376C27.9976 28.2186 27.8888 28.4874 27.6969 28.6861C27.5051 28.8848 27.2455 28.9975 26.9742 29C26.7029 29.0024 26.4415 28.8944 26.2463 28.6992L22.2045 24.5129C19.5632 26.8567 16.1481 28.0498 12.6758 27.842C9.20354 27.6341 5.94394 26.0413 3.58103 23.398C1.21811 20.7546 -0.064444 17.2661 0.00249436 13.6644C0.0694327 10.0628 1.48066 6.62798 3.94005 4.08076C6.39943 1.53354 9.7158 0.0719125 13.1933 0.00258345C16.6707 -0.0667456 20.0389 1.26161 22.5911 3.70892C25.1434 6.15623 26.6812 9.53224 26.8819 13.1286C27.0826 16.7249 25.9306 20.2619 23.6677 22.9975V22.9997ZM13.4523 25.7219C16.4712 25.7219 19.3664 24.4798 21.501 22.2689C23.6357 20.058 24.8349 17.0594 24.8349 13.9328C24.8349 10.8061 23.6357 7.80749 21.501 5.5966C19.3664 3.38571 16.4712 2.14365 13.4523 2.14365C10.4335 2.14365 7.53826 3.38571 5.40361 5.5966C3.26896 7.80749 2.06973 10.8061 2.06973 13.9328C2.06973 17.0594 3.26896 20.058 5.40361 22.2689C7.53826 24.4798 10.4335 25.7219 13.4523 25.7219Z"
                    fill="black" />
            </svg>
            <input v-if="showInput" type="text" v-model="inputValue" @keydown.enter="onEnter" class="for-input"
                placeholder="Ссылочку сюда" />
            <input type="file" id="fileInput" style="display: none;" @change="onFileChange">
            <label @click="showInput = false" for="fileInput">
                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M23.3721 9.4186C23.3721 10.1587 23.0781 10.8686 22.5547 11.3919C22.0314 11.9153 21.3215 12.2093 20.5814 12.2093C19.8413 12.2093 19.1314 11.9153 18.6081 11.3919C18.0847 10.8686 17.7907 10.1587 17.7907 9.4186C17.7907 8.67847 18.0847 7.96864 18.6081 7.44528C19.1314 6.92193 19.8413 6.62791 20.5814 6.62791C21.3215 6.62791 22.0314 6.92193 22.5547 7.44528C23.0781 7.96864 23.3721 8.67847 23.3721 9.4186Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M14.9205 0H15.0795C18.3014 0 20.8256 8.31693e-08 22.7958 0.265116C24.8107 0.535814 26.4014 1.10233 27.6502 2.34977C28.8991 3.5986 29.4642 5.1893 29.7349 7.20558C30 9.17442 30 11.6986 30 14.9205V15.0433C30 17.707 30 19.8865 29.8549 21.6614C29.7098 23.4474 29.4126 24.9363 28.7456 26.1753C28.4526 26.7209 28.0898 27.2107 27.6502 27.6502C26.4014 28.8991 24.8107 29.4642 22.7944 29.7349C20.8256 30 18.3014 30 15.0795 30H14.9205C11.6986 30 9.17442 30 7.20419 29.7349C5.1893 29.4642 3.5986 28.8977 2.34977 27.6502C1.24326 26.5437 0.671163 25.1665 0.368372 23.4558C0.0683722 21.7772 0.0139535 19.6884 0.00279066 17.0958C-3.60617e-08 16.4358 0 15.7381 0 15.0014V14.9205C0 11.6986 8.31693e-08 9.17442 0.265116 7.20419C0.535814 5.1893 1.10233 3.5986 2.34977 2.34977C3.5986 1.10093 5.1893 0.535814 7.20558 0.265116C9.17442 8.31693e-08 11.6986 0 14.9205 0ZM7.48326 2.3386C5.7 2.5786 4.62419 3.03628 3.83023 3.83023C3.03488 4.62558 2.5786 5.7 2.3386 7.48465C2.09581 9.2986 2.09302 11.6819 2.09302 15V16.1777L3.48977 14.9553C4.10243 14.419 4.89603 14.1357 5.70981 14.1626C6.5236 14.1896 7.29672 14.5248 7.87256 15.1005L13.8586 21.0865C14.3231 21.5509 14.9366 21.8366 15.591 21.8933C16.2454 21.9499 16.8988 21.774 17.4363 21.3963L17.8521 21.1033C18.6275 20.5584 19.5648 20.2928 20.5107 20.3498C21.4566 20.4069 22.3552 20.7832 23.0595 21.4172L27.0084 24.9712C27.4074 24.1367 27.6433 23.04 27.7688 21.4926C27.9056 19.8112 27.907 17.7153 27.907 15C27.907 11.6819 27.9042 9.2986 27.6614 7.48465C27.4214 5.7 26.9637 4.62419 26.1698 3.82884C25.3744 3.03488 24.3 2.5786 22.5153 2.3386C20.7014 2.09581 18.3181 2.09302 15 2.09302C11.6819 2.09302 9.29721 2.09581 7.48326 2.3386Z"
                        fill="black" />
                </svg>
            </label>
        </div>
        <div @click="toggleFilters" class="for-filters">
            <svg width="29" height="30" viewBox="0 0 29 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M13.05 17.25V1.4375C13.05 1.05625 13.2028 0.690618 13.4747 0.421034C13.7466 0.15145 14.1154 0 14.5 0C14.8846 0 15.2534 0.15145 15.5253 0.421034C15.7972 0.690618 15.95 1.05625 15.95 1.4375V17.25H17.4C17.7846 17.25 18.1534 17.4015 18.4253 17.671C18.6972 17.9406 18.85 18.3063 18.85 18.6875C18.85 19.0687 18.6972 19.4344 18.4253 19.704C18.1534 19.9735 17.7846 20.125 17.4 20.125H15.95V21.5625C15.95 21.9437 15.7972 22.3094 15.5253 22.579C15.2534 22.8485 14.8846 23 14.5 23C14.1154 23 13.7466 22.8485 13.4747 22.579C13.2028 22.3094 13.05 21.9437 13.05 21.5625V20.125H11.6C11.2154 20.125 10.8466 19.9735 10.5747 19.704C10.3028 19.4344 10.15 19.0687 10.15 18.6875C10.15 18.3063 10.3028 17.9406 10.5747 17.671C10.8466 17.4015 11.2154 17.25 11.6 17.25H13.05ZM23.2 2.875V1.4375C23.2 1.05625 23.3528 0.690618 23.6247 0.421034C23.8966 0.15145 24.2654 0 24.65 0C25.0346 0 25.4034 0.15145 25.6753 0.421034C25.9472 0.690618 26.1 1.05625 26.1 1.4375V2.875H27.55C27.9346 2.875 28.3034 3.02645 28.5753 3.29603C28.8472 3.56562 29 3.93125 29 4.3125C29 4.69375 28.8472 5.05938 28.5753 5.32897C28.3034 5.59855 27.9346 5.75 27.55 5.75H26.1V21.5625C26.1 21.9437 25.9472 22.3094 25.6753 22.579C25.4034 22.8485 25.0346 23 24.65 23C24.2654 23 23.8966 22.8485 23.6247 22.579C23.3528 22.3094 23.2 21.9437 23.2 21.5625V5.75H21.75C21.3654 5.75 20.9966 5.59855 20.7247 5.32897C20.4528 5.05938 20.3 4.69375 20.3 4.3125C20.3 3.93125 20.4528 3.56562 20.7247 3.29603C20.9966 3.02645 21.3654 2.875 21.75 2.875H23.2ZM5.8 7.1875H7.25C7.63456 7.1875 8.00338 7.33895 8.2753 7.60853C8.54723 7.87812 8.7 8.24375 8.7 8.625C8.7 9.00625 8.54723 9.37188 8.2753 9.64147C8.00338 9.91105 7.63456 10.0625 7.25 10.0625H5.8V21.5625C5.8 21.9437 5.64723 22.3094 5.37531 22.579C5.10338 22.8485 4.73456 23 4.35 23C3.96544 23 3.59662 22.8485 3.3247 22.579C3.05277 22.3094 2.9 21.9437 2.9 21.5625V10.0625H1.45C1.06544 10.0625 0.696623 9.91105 0.424695 9.64147C0.152767 9.37188 0 9.00625 0 8.625C0 8.24375 0.152767 7.87812 0.424695 7.60853C0.696623 7.33895 1.06544 7.1875 1.45 7.1875H2.9V1.4375C2.9 1.05625 3.05277 0.690618 3.3247 0.421034C3.59662 0.15145 3.96544 0 4.35 0C4.73456 0 5.10338 0.15145 5.37531 0.421034C5.64723 0.690618 5.8 1.05625 5.8 1.4375V7.1875Z"
                    fill="black" />
            </svg>
        </div>
    </div>
    <div v-if="showFilters" class="filters-con">
        <div class="content">
            <div class="price-shops">
                <div class="price">
                    <input type="text" class="from" placeholder="от">
                    <input type="text" class="to" placeholder="до">
                </div>
                <div class="shops-list">
                    <div class="shop">
                        <span>Яндекс.Маркет</span>
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M22.0025 19.6284C22.0026 19.9399 21.9414 20.2482 21.8223 20.536C21.7032 20.8237 21.5286 21.0852 21.3084 21.3054C21.0882 21.5256 20.8268 21.7003 20.5391 21.8194C20.2513 21.9386 19.943 21.9998 19.6315 21.9998H2.37097C2.05958 21.9998 1.75124 21.9384 1.46356 21.8192C1.17588 21.7001 0.914487 21.5254 0.694318 21.3052C0.474149 21.085 0.299512 20.8236 0.18038 20.5359C0.0612484 20.2482 -4.51235e-05 19.9398 2.49238e-08 19.6284V2.37131C0.000182225 1.74251 0.250027 1.13952 0.69462 0.694863C1.13921 0.250206 1.74217 0.000273388 2.37097 2.49419e-08H19.6281C19.9395 -4.51449e-05 20.2479 0.0612623 20.5356 0.18042C20.8233 0.299578 21.0847 0.474251 21.3048 0.694461C21.525 0.91467 21.6997 1.1761 21.8188 1.46382C21.9379 1.75154 21.9992 2.05991 21.9991 2.37131V19.6284"
                                fill="#DCDCDC" />
                        </svg>
                    </div>
                    <div class="shop">
                        <span>avito.ru</span>
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M22.0025 19.6284C22.0026 19.9399 21.9414 20.2482 21.8223 20.536C21.7032 20.8237 21.5286 21.0852 21.3084 21.3054C21.0882 21.5256 20.8268 21.7003 20.5391 21.8194C20.2513 21.9386 19.943 21.9998 19.6315 21.9998H2.37097C2.05958 21.9998 1.75124 21.9384 1.46356 21.8192C1.17588 21.7001 0.914487 21.5254 0.694318 21.3052C0.474149 21.085 0.299512 20.8236 0.18038 20.5359C0.0612484 20.2482 -4.51235e-05 19.9398 2.49238e-08 19.6284V2.37131C0.000182225 1.74251 0.250027 1.13952 0.69462 0.694863C1.13921 0.250206 1.74217 0.000273388 2.37097 2.49419e-08H19.6281C19.9395 -4.51449e-05 20.2479 0.0612623 20.5356 0.18042C20.8233 0.299578 21.0847 0.474251 21.3048 0.694461C21.525 0.91467 21.6997 1.1761 21.8188 1.46382C21.9379 1.75154 21.9992 2.05991 21.9991 2.37131V19.6284"
                                fill="#DCDCDC" />
                        </svg>
                    </div>
                    <div class="shop">
                        <span>wildberries.ru</span>
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M22.0025 19.6284C22.0026 19.9399 21.9414 20.2482 21.8223 20.536C21.7032 20.8237 21.5286 21.0852 21.3084 21.3054C21.0882 21.5256 20.8268 21.7003 20.5391 21.8194C20.2513 21.9386 19.943 21.9998 19.6315 21.9998H2.37097C2.05958 21.9998 1.75124 21.9384 1.46356 21.8192C1.17588 21.7001 0.914487 21.5254 0.694318 21.3052C0.474149 21.085 0.299512 20.8236 0.18038 20.5359C0.0612484 20.2482 -4.51235e-05 19.9398 2.49238e-08 19.6284V2.37131C0.000182225 1.74251 0.250027 1.13952 0.69462 0.694863C1.13921 0.250206 1.74217 0.000273388 2.37097 2.49419e-08H19.6281C19.9395 -4.51449e-05 20.2479 0.0612623 20.5356 0.18042C20.8233 0.299578 21.0847 0.474251 21.3048 0.694461C21.525 0.91467 21.6997 1.1761 21.8188 1.46382C21.9379 1.75154 21.9992 2.05991 21.9991 2.37131V19.6284"
                                fill="#DCDCDC" />
                        </svg>
                    </div>
                </div>
            </div>
            <div class="buttons">
                <button class="reset">Сбросить</button>
                <button class="apply">Применить</button>
            </div>
        </div>
    </div>
</template>

<style>
:root {
    --background-color: #F8F8F8;
}

body {
    position: relative;
}

.background {
    width: 100vw;
    height: 100vh;
    background: black;
    opacity: 0.2;
    position: fixed;
    z-index: 9;
}

.search-con {
    width: 100vw;
    display: flex;
    flex-direction: row;
    justify-content: center;
    row-gap: 5px;
    position: absolute;
    top: 0;
    z-index: 11;
}

.for-search,
.for-filters {
    background-color: var(--background-color);
    border-radius: 18px;
    padding: 11px;
    margin: 5px;
    width: fit-content;
    height: fit-content;
}

svg {
    cursor: pointer;
    display: flex;
    align-items: center;
}

.for-search {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    width: fit-content;
}

.for-input {
    font-size: 17px;
    height: 30px;
}

.filters-con {
    padding: 10px;
    width: 100%;
    position: fixed;
    bottom: 0;
    background: white;
    border-top-left-radius: 14px;
    border-top-right-radius: 14px;
    z-index: 10;
}

.content {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    row-gap: 120px;
}

.price-shops {
    width: 100%;
}

.price {
    display: flex;
    column-gap: 5px;
    margin-bottom: 30px;
    padding-bottom: 25px;
}

input {
    background-color: var(--background-color);
    border-radius: 100px;
    height: 40px;
    padding: 12px;
    border: none;
    outline: none;
}

input::placeholder {
    color: #BBBBBB;
}

.from {
    flex: 0 0 20%;
}

.to {
    flex: 1;
}

.shops-list {
    display: flex;
    flex-direction: column;
    row-gap: 12px;
}

.shop {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.buttons {
    display: flex;
    column-gap: 10px;
    width: fit-content;
}

button {
    border-radius: 100px;
    border: none;
    padding: 10px 17px;
    background-color: var(--background-color);
}

.apply {
    background-color: #82B5DE;
    color: white;
}

.reset:active {
    background-color: #f0f0f0;
}

.apply:active {
    background-color: #77b0df;
}
</style>